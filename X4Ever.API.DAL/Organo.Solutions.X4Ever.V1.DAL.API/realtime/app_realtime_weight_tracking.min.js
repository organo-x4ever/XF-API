$(function(){function l(){o&&($("#date-submit").val(e),$("button[type=submit].button-search").click())}function a(){$("table[key=data-table] tbody").remove();$(".loading-results").removeClass("hide");$(".div-message").text("");$("button.button-search").addClass("disabled")}function s(){$(".loading-results").addClass("hide");$("button.button-search").removeClass("disabled")}function h(){var e="?fromDate="+t+"&skipUptoId="+u,o=r+c;jQuery.support.cors=!0;$.ajax({url:o+e,type:"GET",dataType:"json",headers:{Token:i},success:function(i){var r,e;if(i!==null&&i.length>0){$.each(i,function(t,i){var r=i.ID-1;n[r]=i});u=n[n.length-1].ID;try{r=n[n.length-1].TrackerLastDate;t=r.split("T")[0]+" "+r.split("T")[1]}catch(o){}e=$("#example2").DataTable({data:n,retrieve:!1,paging:!1,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,search:!0,searchable:!0,pageLength:1e3,lengthMenu:[[25,50,100,500,1e3],[25,50,100,500,1e3]],order:[[0,"desc"]],columns:[{data:"ID"},{data:"FirstName"},{data:"EmailAddress"},{data:"ApplicationName"},{data:"Country"},{data:"TrackerStartDate"},{data:"TrackerLastDate"},{data:"StartWeight"},{data:"WeeklyWeightLost"},{data:"TotalWeightLost"}],columnDefs:[{targets:[0],visible:!1,render:function(n){return n}},{targets:[5],render:function(n,t,i){var r="";try{r=i!==null&&i!=="undefined"&&i.TrackerStartDate!==null&&i.TrackerStartDate!=="null"&&i.TrackerStartDate!=="undefined"?i.TrackerStartDate.split("T")[0]+" "+i.TrackerStartDate.split("T")[1]:""}catch(u){r=""}return r}},{targets:[6],render:function(n,t,i){var r="";try{r=i!==null&&i!=="undefined"&&i.TrackerLastDate!==null&&i.TrackerLastDate!=="null"&&i.TrackerLastDate!=="undefined"?i.TrackerLastDate.split("T")[0]+" "+i.TrackerLastDate.split("T")[1]:""}catch(u){r=""}return r}},{targets:[1],render:function(n,t,i){return n+" "+i.LastName}},],tableTools:{aButtons:["copy","print",{sExtends:"collection",sButtonText:"Save",aButtons:["csv","xls","pdf"]}]},footerCallback:function(){var t=this.api(),data,n=function(n){return typeof n=="string"?n.replace(/[\$,]/g,"")*1:typeof n=="number"?n:0};total_7=t.column(7).data().reduce(function(t,i){return n(t)+n(i)},0);pageTotal_7=t.column(7,{page:"current"}).data().reduce(function(t,i){return n(t)+n(i)},0);$(t.column(7).footer()).html(pageTotal_7+"kg ("+total_7+"kg)");total_8=t.column(8).data().reduce(function(t,i){return n(t)+n(i)},0);pageTotal_8=t.column(8,{page:"current"}).data().reduce(function(t,i){return n(t)+n(i)},0);$(t.column(8).footer()).html(pageTotal_8+"kg ("+total_8+"kg)");total_9=t.column(9).data().reduce(function(t,i){return n(t)+n(i)},0);pageTotal_9=t.column(9,{page:"current"}).data().reduce(function(t,i){return n(t)+n(i)},0);$(t.column(9).footer()).html(pageTotal_9+"kg ("+total_9+"kg)")},destroy:!0})}s();setTimeout(h,f*1e3)},error:function(n){n.status===401&&basics.logout();$(".div-message").text(n.responseText);s()}})}function v(n){var t=r+"realtime/realtime-tracking-config.json";jQuery.support.cors=!0;$.ajax({url:t,type:"GET",dataType:"json",success:function(t){f=t.refreshwaitseconds;e=t.minDate;o=t.fetchRecordOnLoad;n();return},error:function(){}})}var r=basics.baseUrl,i=cookie.getCookie(cookie.tokenHeader);(i===null||i==="undefined"||i.trim().length===0)&&location.replace(r+"view/index.html");var c="api/frontend/getrealtimetrackerrefreshasync",f=60,e="2018-10-15",o=!1;v(l);var u=0,n=[{}],t="";$.fn.datepicker.defaults.format="yyyy-mm-dd";$("#date-submit").datepicker({startDate:"2018-10-15"});$("button[type=submit].button-search").click(function(){if($(this).hasClass("disabled")===!1){n=[{}];u=0;t="";try{if($("#date-submit").val()!==null&&$("#date-submit").val()!=="undefined"&&(t=$("#date-submit").val(),t.indexOf("/")>-1)){var i=t.split("/");t=i[2]+"-"+i[0]+"-"+i[1]}}catch(r){}a();$(".td-start-weight").html("");$(".td-weekly-weight").html("");h()}})});