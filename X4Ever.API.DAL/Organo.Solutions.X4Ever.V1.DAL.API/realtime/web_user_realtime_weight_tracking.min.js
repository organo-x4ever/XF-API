$(function(){function l(){o&&($("#date-submit").val(e),$("button[type=submit].button-search").click())}function a(){$("table[key=data-table] tbody").remove();$(".loading-results").removeClass("hide");$(".div-message").text("");$("button.button-search").addClass("disabled")}function h(){$(".loading-results").addClass("hide");$("button.button-search").removeClass("disabled")}function u(){var e="?fromDate="+t,o=r+c;jQuery.support.cors=!0;$.ajax({url:o+e,type:"GET",dataType:"json",headers:{Token:i},success:function(i){var r,e;if(i===null||i.length===0){$(".div-message").text("Please wait... it is taking longer than required");setTimeout(u,1e4);return}if(i!==null&&i.length>0){$.each(i,function(t,i){var r=i.ID-1;n[r]=i});s=n[n.length-1].ID;try{r=n[n.length-1].TrackerLastDate;t=r.split("T")[0]+" "+r.split("T")[1]}catch(o){}e=$("#example2").DataTable({data:n,retrieve:!1,paging:!1,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,search:!0,searchable:!0,pageLength:1e3,lengthMenu:[[25,50,100,500,1e3],[25,50,100,500,1e3]],order:[[0,"desc"]],columns:[{data:"ID"},{data:"user_first_name"},{data:"user_email"},{data:"application_name"},{data:"country"},{data:"tracker_start_date"},{data:"tracker_last_date"},{data:"start_weight"},{data:"weekly_weight_lost"},{data:"total_weight_lost"}],columnDefs:[{targets:[0],visible:!1},{targets:[5],render:function(n,t,i){var r="";try{r=i!==null&&i!=="undefined"&&i.tracker_start_date!==null&&i.tracker_start_date!=="null"&&i.tracker_start_date!=="undefined"?i.tracker_start_date.split("T")[0]+" "+i.tracker_start_date.split("T")[1]:""}catch(u){r=""}return r}},{targets:[6],render:function(n,t,i){var r="";try{r=i!==null&&i!=="undefined"&&i.tracker_last_date!==null&&i.tracker_last_date!=="null"&&i.tracker_last_date!=="undefined"?i.tracker_last_date.split("T")[0]+" "+i.tracker_last_date.split("T")[1]:""}catch(u){r=""}return r}},{targets:[1],render:function(n,t,i){return n+" "+i.user_last_name}},],tableTools:{aButtons:["copy","print",{sExtends:"collection",sButtonText:"Save",aButtons:["csv","xls","pdf"]}]},footerCallback:function(){var t=this.api(),data,n=function(n){return typeof n=="string"?n.replace(/[\$,]/g,"")*1:typeof n=="number"?n:0};total_7=t.column(7).data().reduce(function(t,i){return parseFloat(n(t)+n(i)).toFixed(2)},0);pageTotal_7=t.column(7,{page:"current"}).data().reduce(function(t,i){return parseFloat(n(t)+n(i)).toFixed(2)},0);$(t.column(7).footer()).html(parseFloat(pageTotal_7).toFixed(2)+"kg ("+parseFloat(total_7).toFixed(2)+"kg)");total_8=t.column(8).data().reduce(function(t,i){return parseFloat(n(t)+n(i)).toFixed(2)},0);pageTotal_8=t.column(8,{page:"current"}).data().reduce(function(t,i){return parseFloat(n(t)+n(i)).toFixed(2)},0);$(t.column(8).footer()).html(parseFloat(pageTotal_8).toFixed(2)+"kg ("+parseFloat(total_8).toFixed(2)+"kg)");total_9=t.column(9).data().reduce(function(t,i){return parseFloat(n(t)+n(i)).toFixed(2)},0);pageTotal_9=t.column(9,{page:"current"}).data().reduce(function(t,i){return parseFloat(n(t)+n(i)).toFixed(2)},0);$(t.column(9).footer()).html(parseFloat(pageTotal_9).toFixed(2)+"kg ("+parseFloat(total_9).toFixed(2)+"kg)")},destroy:!0})}h();$(".div-message").text("");setTimeout(u,f*1e3)},error:function(n){n.status===401&&basics.logout();$(".div-message").text(n.responseText);h()}})}function v(n){var t=r+"realtime/realtime-tracking-config.json";jQuery.support.cors=!0;$.ajax({url:t,type:"GET",dataType:"json",success:function(t){f=t.webuserrefreshwaitseconds;e=t.minDate;o=t.fetchRecordOnLoad;n();return},error:function(){}})}var r=basics.baseUrl,i=cookie.getCookie(cookie.tokenHeader);(i===null||i==="undefined"||i.trim().length===0)&&location.replace(r+"view/index.html");var c="api/frontend/getwebusermetarealtime2018async",f=60,e="2018-10-15",o=!1;v(l);var s=0,n=[{}],t="";$.fn.datepicker.defaults.format="yyyy-mm-dd";$("#date-submit").datepicker({startDate:"2018-10-15"});$("button[type=submit].button-search").click(function(){if($(this).hasClass("disabled")===!1){n=[{}];s=0;t="";try{if($("#date-submit").val()!==null&&$("#date-submit").val()!=="undefined"&&(t=$("#date-submit").val(),t.indexOf("/")>-1)){var i=t.split("/");t=i[2]+"-"+i[0]+"-"+i[1]}}catch(r){}a();$(".td-start-weight").html("");$(".td-weekly-weight").html("");u()}})});