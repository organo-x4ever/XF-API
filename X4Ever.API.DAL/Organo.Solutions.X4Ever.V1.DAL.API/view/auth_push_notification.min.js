function checkPlatform(n){changeView($(n).data("value"),n.checked)}function changeView(n,t){var i=$("#checkIOS"),r=$("#checkAndroid");t?n==="email"?($(".form-email-subject").removeClass("hide"),$(".form-email-body").removeClass("hide"),$(".form-email-footer").removeClass("hide")):(n==="ios"||n==="android")&&(i[0].checked||r[0].checked)&&($(".form-notification-title").removeClass("hide"),$(".form-notification-body").removeClass("hide")):n==="email"?($(".form-email-subject").addClass("hide"),$(".form-email-body").addClass("hide"),$(".form-email-footer").addClass("hide")):(n==="ios"||n==="android")&&(i[0].checked||r[0].checked||($(".form-notification-title").addClass("hide"),$(".form-notification-body").addClass("hide")))}$(function(){function o(){var n=!0;$("#input-emails").val().trim().length===0?($("#input-emails").parent(".form-group").addClass("has-error"),n=!1):$("#input-emails").parent(".form-group").removeClass("has-error");$("#input-auth-code").val().trim().length===0?($("#input-auth-code").parent().parent(".form-group").addClass("has-error"),n=!1):$("#input-auth-code").parent().parent(".form-group").removeClass("has-error");var t=$("#checkEmail"),i=$("#checkIOS"),r=$("#checkAndroid");return t[0].checked||i[0].checked||r[0].checked?($("#checkEmail").parent().parent().parent(".form-group").removeClass("has-error"),$("#checkIOS").parent().parent().parent().parent(".form-group").removeClass("has-error"),$("#checkAndroid").parent().parent().parent().parent(".form-group").removeClass("has-error"),t[0].checked&&($("#emailSubject").val().trim().length===0?($("#emailSubject").parent(".form-group").addClass("has-error"),n=!1):$("#emailSubject").parent(".form-group").removeClass("has-error"),$("#emailBody").val().trim().length===0?($("#emailBody").parent(".form-group").addClass("has-error"),n=!1):$("#emailBody").parent(".form-group").removeClass("has-error")),(i[0].checked||r[0].checked)&&($("#notificationTitle").val().trim().length===0?($("#notificationTitle").parent(".form-group").addClass("has-error"),n=!1):$("#notificationTitle").parent(".form-group").removeClass("has-error"),$("#notificationBody").val().trim().length===0?($("#notificationBody").parent(".form-group").addClass("has-error"),n=!1):$("#notificationBody").parent(".form-group").removeClass("has-error"))):($("#checkEmail").parent().parent().parent(".form-group").addClass("has-error"),$("#checkIOS").parent().parent().parent().parent(".form-group").addClass("has-error"),$("#checkAndroid").parent().parent().parent().parent(".form-group").addClass("has-error"),n=!1),n}function s(){$("table[key=data-table] tbody").remove();$(".loading-results").removeClass("hide");$(".div-message").text("");$("button.button-search").addClass("disabled");$("button.button-send-notification").addClass("disabled")}function r(){$(".loading-results").addClass("hide");$("button.button-search").removeClass("disabled");$("button.button-send-notification").removeClass("disabled")}function h(){$(".model-loading-results").removeClass("hide");$(".div-model-message").text("");$("button[type=button].button-save").addClass("disabled");$("button.btn-default").addClass("disabled")}function u(){$(".model-loading-results").addClass("hide");$("button[type=button].button-save").removeClass("disabled");$("button.btn-default").removeClass("disabled")}function f(){var o,u,f,h;s();o="";$("#date-submit").val()!==null&&$("#date-submit").val()!=="undefined"&&(u=$("#date-submit").val(),u!==null&&u.length>0&&(f=u.split("-"),f.length===2&&(o="?fromDate="+f[0].trim()+"&toDate="+f[1].trim())));h=t+"api/frontend/getbydateasync";jQuery.support.cors=!0;$.ajax({url:h+o,type:"GET",dataType:"json",headers:{Token:n},success:function(n){i=n;var u=$("#example2").DataTable({data:i,retrieve:!1,paging:!1,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,search:!0,searchable:!0,pageLength:1e3,lengthMenu:[[25,50,100,500,1e3],[25,50,100,500,1e3]],order:[[0,"asc"]],columns:[{data:"SentDatetime"},{data:"FirstName"},{data:"NotificationType"},{data:"UserPlatform"},{data:"StatusDescription"},{data:"NotificationBody"}],columnDefs:[{targets:[0],render:function(n,t,i){return i.SentDatetime.split("T")[0]+" "+i.SentDatetime.split("T")[1]}},{targets:[1],render:function(n,t,i){var r;return r=n+" "+i.LastName,r+="<br>",r+i.UserEmail}},{targets:[2],render:function(n,t,i){return i.NotificationType+"<br>"+(i.IsPush?"Push":"E-Mail")+"<br>"+(i.IsScheduled?"Scheduled":"Custom")}},{targets:[5],render:function(n,i,r){return r.IsPush?n:"<a href="+t+"view/body/?key="+r.ID+' target="_blank">Show Message Body<\/a>'}}],tableTools:{aButtons:["copy","print",{sExtends:"collection",sButtonText:"Save",aButtons:["csv","xls","pdf"]}]},destroy:!0});$(".button-notification").click(function(){var n=$(this).data("text"),t=e(i,"ID",n);c(t[0])});r()},error:function(n){n.status===401&&basics.logout();$(".div-message").text(n.responseText);r()}})}function e(n,t,i){var r=[];for(var u in n)n.hasOwnProperty(u)&&(typeof n[u]=="object"?r=r.concat(e(n[u],t,i)):u===t&&n[t]===i&&r.push(n));return r}function c(n){var t=n.SentDatetime.split("T")[0]+" "+n.SentDatetime.split("T")[1];$(".modal-title").text(n.FirstName+" "+n.LastName+" "+t);$(".modal-body p").text(n.NotificationBody);$("#model-testimonial").modal("show")}function l(){$(".modal-title").text("Push Notification");$("#model-notification").modal("show")}function a(n){var t=basics.currentDate();$("#date-submit").val(t+" - "+t);n()}var t=basics.baseUrl,n=cookie.getCookie(cookie.tokenHeader),i;(n===null||n==="undefined"||n.trim().length===0)&&location.replace(t+"view/index.html");$("#date-submit").daterangepicker();i=null;a(f);$("button[type=submit].button-search").click(function(){$(this).hasClass("disabled")===!1&&f()});$("button[type=button].button-send-notification").click(function(){$(this).hasClass("disabled")===!1&&l()});$("button[type=button].button-save").click(function(){var r;if($(this).hasClass("disabled")===!1&&o()){h();var f=t+"api/frontend/postpushnotificationasync",e=$("#checkEmail"),s=$("#checkIOS"),c=$("#checkAndroid"),l=$("#checkEmailFooter"),i="";e[0].checked&&(i+="email");s[0].checked&&(i.trim().length>0&&(i+=","),i+="ios");c[0].checked&&(i.trim().length>0&&(i+=","),i+="android");r="?authCode="+$("#input-auth-code").val().trim()+"&emailIDs="+$("#input-emails").val().trim()+"&sendToPlatforms="+i+"&notificationTitle="+$("#notificationTitle").val().trim()+"&notificationBody="+$("#notificationBody").val().trim()+"&emailSubject="+$("#emailSubject").val().trim()+"&emailBody="+$("#emailBody").val().trim()+"&attachFooter="+l[0].checked;jQuery.support.cors=!0;$.ajax({url:f+r,type:"POST",dataType:"json",headers:{Token:n},success:function(){u();$("#model-notification").modal("hide")},error:function(n){n.status===401&&basics.logout();$(".div-model-message").text(n.responseText);u()}})}})});